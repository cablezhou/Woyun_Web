# 高德地图API配置指南

## 重要提示

⚠️ **双API密钥配置**：项目需要两个不同的高德地图API密钥！
- **JS API密钥**：用于交互式地图显示（路线详情页）
- **Web服务API密钥**：用于静态地图生成（路线缩略图）

详细配置说明请参考：[AMAP_DUAL_KEY_CONFIG.md](./AMAP_DUAL_KEY_CONFIG.md)

## 1. 获取高德地图API密钥

1. 访问 [高德开放平台](https://lbs.amap.com/)
2. 注册/登录账号
3. 进入控制台 -> 应用管理 -> 我的应用
4. **创建两个应用**：
   - 应用1：选择"Web端(JS API)"
   - 应用2：选择"Web服务API"
5. 分别获取两个API Key

## 2. 配置API密钥

### 方法一：环境变量配置（推荐）

1. 在项目根目录找到 `.env.local` 文件
2. 替换其中的API密钥：

```env
# 将这里替换为你的实际API密钥
VITE_AMAP_KEY=你的高德地图API密钥
VITE_AMAP_SECRET=你的高德地图API密钥安全码
```

### 方法二：直接修改配置文件

如果不使用环境变量，可以直接修改 `src/config/index.js` 文件：

```javascript
export const AMAP_CONFIG = {
  // 直接填入你的API密钥
  key: '你的高德地图API密钥',
  secret: '你的高德地图API密钥安全码',
  // ... 其他配置
}
```

## 3. 配置域名白名单

在高德开放平台控制台中：
1. 进入你的应用设置
2. 添加域名白名单：
   - 开发环境：`localhost:5173`
   - 生产环境：你的实际域名

## 4. 启用所需服务

确保在高德控制台中启用以下服务：
- Web服务API
- Web端JS API
- 路径规划API（如需要导航功能）

## 5. 验证配置

配置完成后，访问骑行路线页面，如果地图正常显示，说明配置成功。

## 注意事项

1. **安全性**：
   - 不要将API密钥提交到公开的代码仓库
   - `.env.local` 文件已添加到 `.gitignore` 中
   - 生产环境建议使用服务端代理方式

2. **配额限制**：
   - 免费版本有每日调用次数限制
   - 根据需要选择合适的套餐

3. **功能支持**：
   - GPX文件解析：已实现客户端解析
   - 路线缩略图：需要配合地图截图API
   - 实时导航：需要额外的导航服务权限

## 故障排除

如果遇到以下问题：

1. **地图无法加载**：
   - 检查API密钥是否正确
   - 检查域名白名单设置
   - 查看浏览器控制台错误信息

2. **配置未生效**：
   - 重启开发服务器：`npm run dev`
   - 清除浏览器缓存

3. **权限错误**：
   - 确认API密钥对应的服务已启用
   - 检查账户余额和配额

## 联系支持

如有问题，可以：
- 查看高德开放平台文档
- 联系高德技术支持
- 在项目中提交Issue